#!/bin/sh
# Remove stale netplan YAML files generated by initramfs configure_networking().
# Without this, the initramfs DHCP config for clevis/tang persists into userspace
# via /run/netplan/<iface>.yaml and causes netplan generate to re-enable DHCP
# on physical interfaces that should be unmanaged OVS bridge ports.

PREREQ=""

prereqs() {
    echo "$PREREQ"
}

case "$1" in
    prereqs)
        prereqs
        exit 0
    ;;
esac

rm -rvf /run/netplan/*
